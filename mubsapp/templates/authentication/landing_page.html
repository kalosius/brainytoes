{% extends 'base.html' %}
{% block title %}Welcome To BrainyToes|Landing Page{% endblock %}
{% block content %}

<div class="container mx-auto mt-10">
    <div class="text-center">
        <h1 class="text-4xl font-bold mb-5 text-green-500" id="welcomeText">Welcome To BrainyToes By <span class="text-red-500">"Aloisius"</span></h1>
        <script>
            const textElement = document.getElementById('welcomeText');
            const text = textElement.innerText;
            let index = 0;
            let deleting = false;
            let hasTyped = false;

            function typeEffect() {
                if (deleting) {
                    textElement.innerText = text.substring(0, index--);
                    if (index < 0) {
                        deleting = false;
                        hasTyped = true;
                    }
                } else {
                    textElement.innerText = text.substring(0, index++);
                    if (index > text.length) {
                        deleting = true;
                    }
                }
                if (!hasTyped) {
                    setTimeout(typeEffect, 200);
                }
            }

            typeEffect();
        </script>
        <p class="mb-5">Search and download software, PDFs, and watch videos on how to install the downloaded software.</p>
        <input type="text" placeholder="Search..." class="border p-2 rounded w-full max-w-md mx-auto mb-5">
        <div class="flex justify-center">
            <button class="bg-blue-500 text-white px-4 py-2 rounded">Search</button>
        </div>
    </div>

    <!-- Categories Carousel -->
    <div class="mt-10">
        <h2 class="text-2xl font-bold mb-5">Categories of Products</h2>
        <div id="categoriesCarousel" class="carousel">
            <!-- Categories will be inserted here by JavaScript -->
        </div>
    </div>

    <!-- Books Carousel -->
    <div class="mt-10">
        <h2 class="text-2xl font-bold mb-5">Books</h2>
        <div id="booksCarousel" class="carousel">
            <!-- Books will be inserted here by JavaScript -->
        </div>
    </div>

    <!-- Recent Activities -->
    <div class="mt-10">
        <h2 class="text-2xl font-bold mb-5">Recent Activities</h2>
        <div id="recentActivities" class="activities">
            <!-- Recent activities will be inserted here by JavaScript -->
        </div>
    </div>

    <h2>Categories</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {% for category in categories %}
            <div class="card bg-white shadow-md rounded-lg p-4">
                <h3 class="text-xl font-bold">{{ category.name }}</h3>
            </div>
        {% endfor %}
    </div>

    <h2>Products</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {% for product in products %}
            <div class="card bg-white shadow-md rounded-lg p-4">
                <h3 class="text-xl font-bold">{{ product.name }}</h3>
            </div>
        {% endfor %}
    </div>

    <h2>Books</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {% for book in books %}
            <div class="card bg-white shadow-md rounded-lg p-4">
                <h3 class="text-xl font-bold">{{ book.title }}</h3>
            </div>
        {% endfor %}  
    </div>
<!-- Chatbot Icon -->
<div id="chatbotIcon" class="fixed bottom-0 right-0 m-4 cursor-pointer">
    <img src="https://cdn-icons-png.flaticon.com/512/4712/4712100.png" alt="Chatbot Icon" class="w-16 h-16">
</div>
<!-- Chatbot Section -->
<div id="chatbotSection" class="fixed bottom-0 right-0 m-4 hidden transition-opacity duration-500 opacity-0">
    <div class="bg-white border rounded-lg shadow-lg p-4 relative">
        <button id="closeChatbot" class="absolute top-0 right-0 mt-2 mr-2 text-gray-500 hover:text-gray-700">
            &times;
        </button>
        <h2 class="text-xl font-bold mb-2">Chat with us</h2>
        <div id="chatbox" class="h-64 overflow-y-scroll border p-2 mb-2"></div>
        <input type="text" id="userInput" placeholder="Type a message..." class="border p-2 rounded w-full mb-2">
        <button id="sendButton" class="bg-blue-500 text-white px-4 py-2 rounded w-full">Send</button>
    </div>
</div>

<script>
    document.getElementById('chatbotIcon').addEventListener('click', function() {
        const chatbotSection = document.getElementById('chatbotSection');
        chatbotSection.classList.remove('hidden');
        setTimeout(() => chatbotSection.classList.remove('opacity-0'), 10);
    });

    document.getElementById('closeChatbot').addEventListener('click', function() {
        const chatbotSection = document.getElementById('chatbotSection');
        chatbotSection.classList.add('opacity-0');
        chatbotSection.addEventListener('transitionend', () => {
            if (chatbotSection.classList.contains('opacity-0')) {
                chatbotSection.classList.add('hidden');
            }
        }, { once: true });
    });

    // Sample data
    const categories = ['{{products}}'];
    const books = ['{{books}}'];
    const activities = ['{{categories}}'];

    // Shuffle function
    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    // Shuffle data
    shuffle(categories);
    shuffle(books);
    shuffle(activities);

    // Insert categories into carousel
    const categoriesCarousel = document.getElementById('categoriesCarousel');
    categories.forEach(category => {
        const div = document.createElement('div');
        div.className = 'carousel-item';
        div.innerText = category;
        categoriesCarousel.appendChild(div);
    });

    // Insert books into carousel
    const booksCarousel = document.getElementById('booksCarousel');
    books.forEach(book => {
        const div = document.createElement('div');
        div.className = 'carousel-item';
        div.innerText = book;
        booksCarousel.appendChild(div);
    });

    // Insert recent activities
    const recentActivities = document.getElementById('recentActivities');
    activities.forEach(activity => {
        const div = document.createElement('div');
        div.className = 'activity-item';
        div.innerText = activity;
        recentActivities.appendChild(div);
    });
</script>
{% endblock %}